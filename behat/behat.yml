default: # Our DEFAULT profile targets the APACHE container with the @apache tag
  suites:
    default:
      contexts:
        - Drupal\DrupalExtension\Context\DrupalContext
        - Drupal\DrupalExtension\Context\MinkContext
        - Drupal\DrupalExtension\Context\MessageContext
        - Drupal\DrupalExtension\Context\DrushContext
        - FeatureContext:
            parameters:
              environment_identifier: 'dev'
              assets_path: %paths.base%/features/assets/

      filters:
        tags: "@apache"
  extensions:
    Behat\MinkExtension:
      base_url: http://apache
      sessions:
        default:
          goutte:
            guzzle_parameters:
              verify: false
      javascript_session: 'selenium2'
      # default_session: 'selenium2'
      goutte: ~
      selenium2:
        wd_host: http://hub:4444/wd/hub
        capabilities:
          browserName: chrome
          browser: chrome
          version: 'ANY'
          browserVersion: 'ANY'
          chrome:
            switches:
              - "--no-sandbox"
              - "--headless"
              - "--disable-gpu"
              - "--timeout 15000"
              - "--allow-insecure-localhost"
              - "--allow-running-insecure-content"
              - "--ignore-certificate-errors"
              - "--window-size=1280,1600"
      browser_name: 'chrome'
      files_path: %paths.base%/features/assets/
    Drupal\DrupalExtension:
      blackbox: ~
      region_map:
        footer: '.region-footer'
        page_header: '#page-header-container'
        main_nav: '.main-nav'
        breadcrumb: '.breadcrumb'
        global_search: '#global-search'
        content: '.region-content'
        colorbox: '#colorbox'
        sidebar_first: '.region-sidebar-first'
        islandora_display: '.islandora-object-content-wrapper'
        object_metadata: '#object_metadata'
        compound_object_metadata: '#compound_parent_metadata'
        jail_wrapper: '.jail-wrapper'
        object_links: '#object_links'
        object_content: '.islandora-object-content'
        in_collection: '#block-system-main .in-collection'
        mezzanine_row: '.mezzanine.row'
        search_controls: '.row.search-controls'
        primary_tabs: 'ul.tabs--primary, ul.tabs.primary'
        secondary_tabs: 'ul.tabs--secondary, ul.tabs.secondary'

      selectors:
        message_selector: '.messages'
        error_message_selector: '.messages.error'
        success_message_selector: '.messages.status'
        warning_message_selector: '.messages.warning'

      api_driver: 'drupal'
      drush:
        alias: 'self'
        root: '/var/www/html'
      drupal:
        drupal_root: '/var/www/html'

    Lakion\Behat\MinkDebugExtension:
      directory: %paths.base%/debug/logs
      screenshot: true
      clean_start: true

# tests to global services require base_url overrides, which each require a "profile"
# to include a test in these profiles, tag it appropriately
solr: # SOLR profile
  suites:
    default:
      filters:
        tags: "@solr"
  extensions:
    Behat\MinkExtension:
      base_url: http://solr:8080
traefik: # TRAEFIK profile
  suites:
    default:
      filters:
        tags: "@traefik"
  extensions:
    Behat\MinkExtension:
      base_url: http://traefik:8080
# TODO need other service profiles

# Local vagrant profile for pat dunlavey. Use --profile=vagrant_pat in the behat command.
pat:
  suites:
    default:
      filters:
#        tags: "@prod"
      contexts:
        - Drupal\DrupalExtension\Context\DrupalContext
        - Drupal\DrupalExtension\Context\MinkContext
        - Drupal\DrupalExtension\Context\MessageContext
        - Drupal\DrupalExtension\Context\DrushContext
        - FeatureContext:
            parameters:
              environment_identifier: 'vagrant_pat'
              assets_path: %paths.base%/features/assets/
  extensions:
    Behat\MinkExtension:
      goutte:
        guzzle_parameters:
          # Disable SSL certificate validation
          verify: false
          ssl.certificate_authority: false
      base_url: https://compass.localdomain

# Dev server profile. Use --profile=dev in the behat command.
dev:
  suites:
    default:
      contexts:
        - Drupal\DrupalExtension\Context\DrupalContext
        - Drupal\DrupalExtension\Context\MinkContext
        - Drupal\DrupalExtension\Context\MessageContext
        - Drupal\DrupalExtension\Context\DrushContext
        - FeatureContext:
            parameters:
              environment_identifier: 'dev'
              assets_path: %paths.base%/features/assets/
  extensions:
    Behat\MinkExtension:
      base_url: https://compass-dev.fivecolleges.edu

# Staging server profile. Use --profile=staging in the behat command.
staging:
  suites:
    default:
      contexts:
        - Drupal\DrupalExtension\Context\DrupalContext
        - Drupal\DrupalExtension\Context\MinkContext
        - Drupal\DrupalExtension\Context\MessageContext
        - Drupal\DrupalExtension\Context\DrushContext
        - FeatureContext:
            parameters:
              environment_identifier: 'staging'
              assets_path: %paths.base%/features/assets/
  extensions:
    Behat\MinkExtension:
      base_url: https://compass-stage.fivecolleges.edu

# New prod server profile. Use --profile=newprod in the behat command.
newprod:
  suites:
    default:
      filters:
        tags: "@prod"
      contexts:
        - Drupal\DrupalExtension\Context\DrupalContext
        - Drupal\DrupalExtension\Context\MinkContext
        - Drupal\DrupalExtension\Context\MessageContext
        - Drupal\DrupalExtension\Context\DrushContext
        - FeatureContext:
            parameters:
              environment_identifier: 'staging'
              assets_path: %paths.base%/features/assets/
  extensions:
    Behat\MinkExtension:
      base_url: https://compass.fivecolleges.edu


##############################################################################
######   DISABLED: behat should not be used on the production server!   ######
## Production server profile. Use --profile=prod in the behat command.
#prod:
#  extensions:
#    Behat\MinkExtension:
#      base_url: https://compass.fivecolleges.edu
##############################################################################
